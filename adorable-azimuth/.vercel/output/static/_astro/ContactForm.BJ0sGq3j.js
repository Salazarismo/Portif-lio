import"./preact.module.IsPPbktY.js";import{d as o}from"./hooks.module.DgMOKmnS.js";import{u as e}from"./jsxRuntime.module.BSCWCfwz.js";function g(){const[t,a]=o("idle"),[d,r]=o("");async function l(i){if(i.preventDefault(),!(i.target instanceof HTMLFormElement))return;a("submitting");try{window.dispatchEvent(new CustomEvent("appstate:set",{detail:{state:"loading",message:"Enviando…"}}))}catch{}const n=new FormData(i.target),c={name:String(n.get("name")||""),email:String(n.get("email")||""),message:String(n.get("message")||""),hp:String(n.get("hp")||"")};try{const s=await fetch("/api/contact",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)});if(s.ok){a("success"),r("Mensagem enviada. Obrigado!");try{window.dispatchEvent(new CustomEvent("appstate:set",{detail:{state:"success",message:"Mensagem enviada"}}))}catch{}i.target.reset()}else{a("error");const m=await s.json().catch(()=>({}));r(m.error||"Falha ao enviar.");try{window.dispatchEvent(new CustomEvent("appstate:set",{detail:{state:"error",message:"Falha ao enviar"}}))}catch{}}}catch{a("error"),r("Erro de rede.");try{window.dispatchEvent(new CustomEvent("appstate:set",{detail:{state:"error",message:"Erro de rede"}}))}catch{}}}return e("form",{onSubmit:l,class:"grid",style:"gap: var(--spacing-3)","data-state":t,children:[e("div",{children:[e("label",{for:"name",children:"Nome"}),e("input",{id:"name",name:"name",type:"text",required:!0,class:"ui-input"})]}),e("div",{children:[e("label",{for:"email",children:"Email"}),e("input",{id:"email",name:"email",type:"email",required:!0,class:"ui-input"})]}),e("div",{children:[e("label",{for:"message",children:"Mensagem"}),e("textarea",{id:"message",name:"message",rows:4,required:!0,class:"ui-textarea"})]}),e("div",{"aria-hidden":"true",class:"sr-only",children:[e("label",{htmlFor:"hp",children:"Não preencher"}),e("input",{id:"hp",name:"hp",type:"text",tabIndex:-1,autoComplete:"off"})]}),e("button",{type:"submit",disabled:t==="submitting",class:"ui-button",children:t==="submitting"?"Enviando...":"Enviar"}),t!=="idle"&&e("p",{"aria-live":"polite","data-text":"ui-helper",children:d})]})}export{g as default};
