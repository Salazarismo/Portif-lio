---
interface Props { headers: string[]; rows: string[][]; caption?: string }
const { headers, rows, caption = '' } = Astro.props as Props;
---
<div data-cell data-z="1" style="overflow-x:auto; border-radius: var(--radius-md); box-shadow: var(--elevation-1)">
  <table style="width:100%; border-collapse: collapse; color: var(--ink-1); background: var(--surface-1)" role="table">
    {caption && (<caption style="padding: var(--spacing-2) var(--spacing-3)">{caption}</caption>)}
    <thead>
      <tr>
        {headers.map((h, i) => (
          <th scope="col" data-text="ui-label" style={`text-align:${i === headers.length - 1 ? 'right' : 'left'}; background: var(--surface-2); position: sticky; top: 0; padding: var(--space-2) var(--space-3)`}>{h}</th>
        ))}
      </tr>
    </thead>
    <tbody>
      {rows.map((r) => (
        <tr>
          {r.map((c, i) => {
            const isFirst = i === 0;
            const isStatus = headers[i]?.toLowerCase() === 'status';
            const isMetric = headers[i]?.toLowerCase() === 'métrica';
            let content = c;
            if (isStatus) {
              let tone = 'neutral';
              const v = c.toLowerCase();
              if (v.includes('concluído')) tone = 'success';
              else if (v.includes('estável')) tone = 'neutral';
              else if (v.includes('pendente')) tone = 'danger';
              content = `<span style="display:inline-block; padding:2px 8px; border-radius: var(--radius-md); background:${tone==='success'?'var(--success)':'var(--surface-2)'}; color:${tone==='success'?'var(--success-ink)':'var(--ink-1)'}">${c}</span>`;
            }
            if (isMetric) {
              const lc = c.toLowerCase();
              const good = lc.includes('0.95s') || lc.includes('0 violações') || lc.includes('0,95s');
              content = `<strong style="color:${good?'var(--success)':'var(--ink-1)'}">${c}</strong>`;
            }
            return (
              <td data-text={isFirst ? 'heading-lg' : 'body-normal'} style={`border-top-style: solid; border-top-color: var(--color-border); border-top-width: var(--border-width-1); padding: var(--space-2) var(--space-3); text-align:${i === r.length - 1 ? 'right' : 'left'}`} set:html={content}></td>
            )
          })}
        </tr>
      ))}
    </tbody>
  </table>
</div>
