---
import BaseLayout from "@/components/BaseLayout.astro";
import Header from "@/components/Header.astro";
import Footer from "@/components/Footer.astro";
import Divider from "@/components/ui/Divider.astro";
import { AspectRatioImage } from "@/components/ui/AspectRatioImage";
import { createT, loadMessages, type Locale } from "@/i18n";
import { getRelativeLocaleUrl } from "astro:i18n";
export const prerender = false;

const pathname = Astro.url.pathname;
const locale = (Astro.currentLocale || (pathname.startsWith("/en") ? "en" : "pt-br")) as Locale;
const tCommon = createT(loadMessages(locale, "common"), { locale, namespace: "common" });
const tProjects = createT(loadMessages(locale, "projects"), { locale, namespace: "projects" });
const tP7 = createT(loadMessages(locale, "project_p7"), { locale, namespace: "project_p7" });
---
<BaseLayout title={tP7("project_p7.meta.title")} description={tP7("project_p7.meta.description")}>
  <Fragment slot="nav"><Header /></Fragment>
  <div class="container">
    <section aria-labelledby="hero-p7">
      <h1 id="hero-p7" data-text="heading-2xl">{tP7("project_p7.hero.title")}</h1>
      <p data-text="body-muted">{tP7("project_p7.hero.subtitle")}</p>
      <p data-text="ui-label">{tP7("project_p7.hero.kpi")}</p>
      <p style="margin-top: var(--space-1)"><span class="nl-badge" data-variant="secondary" data-ladder={tP7("project_p7.hero.ladder")}>{tP7("project_p7.hero.ladder")}</span></p>
      <div class="nl-hero-actions" style="margin-top: var(--space-2)">
        <a class="nl-btn" href="mailto:victor.de.alcantara.bueno@gmail.com?subject=Solicita%C3%A7%C3%A3o%20de%20repo%20%2F%20README%20(Plataforma%20Ingressos%20WhatsApp)" rel="noopener noreferrer">{tCommon("common.cta.repo")}</a>
        <a class="nl-btn" href="https://wa.me/5548984586949" target="_blank" rel="noopener noreferrer">{tCommon("common.cta.contact")}</a>
      </div>
      <div style="margin-top: var(--space-3)">
        <figure>
          <AspectRatioImage
            src="/images/98f5ae2c-0f91-4fda-9e44-1fd81a607417.png"
            alt={tP7("project_p7.hero.image_alt")}
            ratio={16 / 3}
            loading="lazy"
            decoding="async"
          />
          <figcaption data-text="ui-helper" style="margin-top: var(--space-1)">{tP7("project_p7.hero.figure_caption")}</figcaption>
        </figure>
      </div>
    </section>
    <Divider />
    <section aria-labelledby="tldr-p7">
      <h2 id="tldr-p7" data-text="heading-xl">{tProjects("projects.sections.tldr")}</h2>
      <div style="display:grid; gap: var(--space-1); margin-top: var(--space-2)">
        <p data-text="body-normal"><strong>{tP7("project_p7.tldr.problem_label")}</strong> {tP7("project_p7.tldr.problem")}</p>
        <p data-text="body-normal"><strong>{tP7("project_p7.tldr.solution_label")}</strong> {tP7("project_p7.tldr.solution")}</p>
        <p data-text="body-normal"><strong>{tP7("project_p7.tldr.result_label")}</strong> {tP7("project_p7.tldr.result")}</p>
      </div>
      <div style="margin-top: var(--space-2)">
        <span data-text="body-muted">{tP7("project_p7.tldr.note")}</span>
      </div>
    </section>
    <Divider />
    <section aria-labelledby="snapshot-p7">
      <h2 id="snapshot-p7" data-text="heading-xl">{tProjects("projects.sections.snapshot")}</h2>
      <div class="grid-12 gap-token-4" style="margin-top: var(--space-2)">
        <div style="grid-column: span 4">
          <div data-text="ui-label">{tProjects("projects.labels.role_scope_time")}</div>
          <p data-text="body-normal">{tP7("project_p7.snapshot.col1")}</p>
        </div>
        <div style="grid-column: span 4">
          <div data-text="ui-label">{tProjects("projects.labels.scale_min")}</div>
          <p data-text="body-normal">{tP7("project_p7.snapshot.col2")}</p>
        </div>
        <div style="grid-column: span 4">
          <div data-text="ui-label">{tProjects("projects.labels.constraints_min")}</div>
          <p data-text="body-normal">{tP7("project_p7.snapshot.col3")}</p>
        </div>
      </div>
    </section>
    <Divider />
    <section aria-labelledby="problem-impact-p7">
      <h2 id="problem-impact-p7" data-text="heading-xl">{tProjects("projects.sections.problem_impact")}</h2>
      <ul class="case-psr">
        <li data-text="body-normal"><strong>{tP7("project_p7.problem_impact.symptoms_label")}</strong> {tP7("project_p7.problem_impact.symptoms")}</li>
        <li data-text="body-normal"><strong>{tP7("project_p7.problem_impact.cause_label")}</strong> {tP7("project_p7.problem_impact.cause")}</li>
        <li data-text="body-normal"><strong>{tP7("project_p7.problem_impact.impact_label")}</strong> {tP7("project_p7.problem_impact.impact")}</li>
      </ul>
    </section>
    <Divider />
    <section aria-labelledby="approach-p7">
      <h2 id="approach-p7" data-text="heading-xl">{tProjects("projects.sections.approach")}</h2>
      <p data-text="body-normal">{tP7("project_p7.approach.intro")}</p>
      <ol class="case-psr">
        <li data-text="body-normal"><strong>{tP7("project_p7.approach.step1_label")}</strong> {tP7("project_p7.approach.step1")}</li>
        <li data-text="body-normal"><strong>{tP7("project_p7.approach.step2_label")}</strong> {tP7("project_p7.approach.step2")}</li>
        <li data-text="body-normal"><strong>{tP7("project_p7.approach.step3_label")}</strong> {tP7("project_p7.approach.step3")}</li>
      </ol>
      <div class="case-stack" style="margin-top: var(--space-2)">
        <div data-text="ui-label">{tP7("project_p7.stack.title")}</div>
        <div class="case-chips">
          <span class="case-chip">{tP7("project_p7.stack.chip1")}</span>
          <span class="case-chip">{tP7("project_p7.stack.chip2")}</span>
          <span class="case-chip">{tP7("project_p7.stack.chip3")}</span>
          <span class="case-chip">{tP7("project_p7.stack.chip4")}</span>
        </div>
      </div>
    </section>
    <Divider />
    <section aria-labelledby="reliability-p7">
      <h2 id="reliability-p7" data-text="heading-xl">{tProjects("projects.sections.reliability")}</h2>
      <div style="display:grid; gap: var(--space-2); margin-top: var(--space-2)">
        <p data-text="body-normal"><strong>{tP7("project_p7.reliability.risks_label")}</strong> {tP7("project_p7.reliability.risks")}</p>
        <p data-text="body-normal"><strong>{tP7("project_p7.reliability.guarantees_label")}</strong> {tP7("project_p7.reliability.guarantees")}</p>
        <p data-text="body-normal"><strong>{tP7("project_p7.reliability.evidence_label")}</strong> {tP7("project_p7.reliability.evidence")}</p>
      </div>
      <pre style="margin-top: var(--space-2)">
<code data-text="body-normal">await db.add('syncQueue', &#123;
  url,
  method,
  body,
  timestamp: Date.now(),
  retryCount: 0
&#125;);
// offline POS: /admin/pos/orders -&gt; /admin/pos/sync (batch)
await fetch(syncUrl, &#123; method: 'POST', body: JSON.stringify(&#123; orders &#125;) &#125;);</code>
      </pre>
    </section>
    <Divider />
    <section aria-labelledby="next-p7">
      <h2 id="next-p7" data-text="heading-xl">{tProjects("projects.sections.next")}</h2>
      <ul class="case-psr">
        <li data-text="body-normal">{tP7("project_p7.next.item1")}</li>
        <li data-text="body-normal">{tP7("project_p7.next.item2")}</li>
        <li data-text="body-normal">{tP7("project_p7.next.item3")}</li>
      </ul>
    </section>
    <Divider />
    <section aria-labelledby="conversion-p7">
      <h2 id="conversion-p7" data-text="heading-xl">{tProjects("projects.sections.conversion")}</h2>
      <p data-text="body-normal">{tP7("project_p7.conversion.p")}</p>
      <div class="case-conversion">
        <a class="case-cta" href="https://wa.me/5548984586949" target="_blank" rel="noopener noreferrer">{tP7("project_p7.conversion.whatsapp")}</a>
        <a class="case-cta-secondary" href="mailto:victor.de.alcantara.bueno@gmail.com?subject=Solicita%C3%A7%C3%A3o%20de%20repo%20%2F%20README%20(Plataforma%20Ingressos%20WhatsApp)" rel="noopener noreferrer">{tCommon("common.cta.repo")}</a>
        <a class="case-cta-secondary" href={`${getRelativeLocaleUrl(locale, "")}#projects`}>{tProjects("projects.buttons.back")}</a>
        <a class="case-cta-secondary" href={getRelativeLocaleUrl(locale, "projects/p3")}>{tProjects("projects.buttons.next")}</a>
        <span data-text="ui-helper">{tP7("project_p7.conversion.availability")}</span>
      </div>
    </section>
  </div>
  <Fragment slot="footer"><Footer /></Fragment>
</BaseLayout>
