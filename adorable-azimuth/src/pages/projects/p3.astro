---
import BaseLayout from "../../components/BaseLayout.astro";
import Divider from "../../components/ui/Divider.astro";
import { AspectRatioImage } from "@/components/ui/AspectRatioImage";
export const prerender = false;
---
<BaseLayout title="Habit Analyzer — Victor de Alcântara Bueno" description="Aplicativo web de acompanhamento de hábitos com analytics e relatórios.">
  <div class="container">
    <section aria-labelledby="title">
      <h1 id="title" data-text="heading-2xl">Habit Analyzer</h1>
      <p data-text="body-muted">Aplicativo web de acompanhamento de hábitos com analytics e relatórios.</p>
      <p data-text="ui-label">Pré‑agregação e cache reduziram em até 40% o custo de leitura de analytics em janelas grandes.</p>
      <p style="margin-top: var(--space-1)"><span class="nl-badge" data-variant="secondary" data-ladder="Custo">Custo</span></p>
      <section aria-labelledby="tldr-p3">
        <h2 id="tldr-p3" data-text="heading-lg">TL;DR</h2>
        <p data-text="body-normal">Engenheiro full‑stack — reduzi custo de leitura de analytics em até 40%.</p>
        <ul class="case-psr">
          <li data-text="body-normal"><strong>Problema:</strong> analytics lentos em janelas grandes.</li>
          <li data-text="body-normal"><strong>Solução:</strong> pré‑agregação diária + cache versionado.</li>
          <li data-text="body-normal"><strong>Resultado:</strong> −40% latência e fluxo crítico coberto por E2E.</li>
        </ul>
        <div class="case-stack">
          <div data-text="ui-label">Stack</div>
          <div class="case-chips">
            <span class="case-chip">Pré‑agregação</span>
            <span class="case-chip">Cache versionado</span>
            <span class="case-chip">E2E</span>
            <span class="case-chip">Analytics</span>
          </div>
        </div>
        <div style="margin-top: var(--space-2)">
          <a href="https://github.com/Salazarismo/habit_analyzer" target="_blank" rel="noopener noreferrer" data-text="ui-label">Código / README</a>
        </div>
      </section>
      <div>
        <AspectRatioImage
          src="https://images.unsplash.com/photo-1518770660439-4636190af475?auto=format&fm=jpg&w=1200&q=80"
          alt="Imagem ilustrativa de programação e tecnologia"
          ratio={16 / 9}
          loading="lazy"
          decoding="async"
        />
      </div>
    </section>
    <Divider />
    <section aria-labelledby="problem">
      <h2 id="problem" data-text="heading-xl">Por que isso existe?</h2>
      <p data-text="body-normal">Sem visibilidade diária/aggregada, consistência cai e revisão é difícil.</p>
      <p data-text="body-normal">Decisões de ajuste ficam imprecisas sem métricas claras.</p>
      <p data-text="body-normal">Sem registros consolidados, análise semanal/mensal se torna onerosa.</p>
      <div>
        <figure>
          <AspectRatioImage
            src="/images/analytics-code.svg"
            alt="Visual de analytics: trecho de código de resumo e cache"
            ratio={2 / 1}
            loading="lazy"
            decoding="async"
          />
          <figcaption data-text="ui-helper" style="margin-top: var(--space-1)">Visual de analytics</figcaption>
        </figure>
        <figure>
          <pre class="case-diagram" data-text="body-normal">Evento (habit) → resumo diário (pré‑agregado)
Resumo + janela (days) + versão → cache_key
cache hit → resposta rápida
cache miss → calcula → grava cache</pre>
          <figcaption data-text="ui-helper" style="margin-top: var(--space-1)">Diagrama simples: por que o cache versionado evita recomputação.</figcaption>
        </figure>
      </div>
    </section>
    <Divider />
    <section aria-labelledby="quality">
      <h2 id="quality" data-text="heading-xl">Qualidade e Engenharia</h2>
      <p data-text="body-normal">A chave do cache inclui janela e versão para invalidar com segurança quando a regra de resumo muda.</p>
      <pre>
<code data-text="body-normal">cache_key = (str(user_id), str(habit_id), int(days), int(habit.summary_version or 0))
use_daily = settings.USE_SUMMARY_DAILY and days &lt;= settings.SUMMARY_WINDOW_DAYS</code>
      </pre>
    </section>
    <Divider />
    <section aria-labelledby="conversion-p3">
      <h2 id="conversion-p3" data-text="heading-xl">Se você tem esse tipo de problema</h2>
      <p data-text="body-normal">Se você precisa reduzir custo/latência de analytics sem perder consistência, eu projeto pré‑agregação + cache versionado e testo o fluxo crítico.</p>
      <div class="case-conversion">
        <a class="case-cta" href="https://wa.me/5548984586949" target="_blank" rel="noopener noreferrer">Falar no WhatsApp</a>
        <a class="case-cta-secondary" href="https://github.com/Salazarismo/habit_analyzer" target="_blank" rel="noopener noreferrer">Ver repo</a>
        <span data-text="ui-helper">Disponível para projetos em 2026.</span>
      </div>
    </section>
  </div>
</BaseLayout>
